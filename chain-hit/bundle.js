/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports) {

	"use strict";
	
	window.onload = function () {
	
	  var canvas = document.getElementById("canvas");
	  var ctx = canvas.getContext("2d");
	  var canvasSmoke = document.getElementById("canvas-smoke");
	  var ctxs = canvasSmoke.getContext("2d");
	  var towerImg = new Image();
	  var qualm = new Image();
	  towerImg.onload = function () {
	    qualm.onload = start;
	    qualm.src = "qualm.png";
	  };
	  towerImg.src = "tower.png";
	  var enemy1 = { x: 100, y: 500, radius: 15 };
	  var enemy2 = { x: -100, y: 500, radius: 15 };
	  var tower1 = { x: 500, y: 200, radius: 25 };
	  var factor = 2;
	  var targetFactor = 0;
	  var counter = 0;
	  var status = 0; //idle, 1: shooting, 2: reloading
	  var enemyFactor = 0;
	
	  function animationLoop() {
	
	    if (counter <= 800) {
	      window.requestAnimationFrame(animationLoop);
	    }
	    ctxs.globalAlpha = 0.5;
	    ctx.clearRect(0, 0, 800, 600);
	    ctxs.clearRect(0, 0, 800, 600);
	    drawEnemy(enemy1, ctx);
	    drawEnemy(enemy2, ctx);
	
	    if (counter > 120 && counter <= 400) {
	      status = 1;
	    } else if (counter > 300 && counter <= 550) {
	      status = 2;
	    } else {
	      status = 0;
	    }
	
	    switch (status) {
	      case 0:
	        drawIdleTower(tower1, ctx, towerImg, 0, enemy1);
	        break;
	      case 1:
	        var smoke = calcSmokeTarget(enemy1, tower1, factor, targetFactor);
	
	        var _calcStartingPoint = calcStartingPoint(smoke, tower1);
	
	        var startX = _calcStartingPoint.startX;
	        var startY = _calcStartingPoint.startY;
	
	        var startingAngle = calcStartingAngle(smoke, tower1, startX);
	        if (targetFactor < 1) {
	          targetFactor += 1 / 60;
	        } else {
	          targetFactor = 1;
	        }
	        drawRotatingTower(tower1, ctx, towerImg, status, startingAngle);
	        drawSmoke(enemy1, tower1, factor, targetFactor, smoke, startX, startY, startingAngle, ctxs);
	        drawChainSmoke(enemy1, enemy2, ctxs, 1.5, qualm);
	        break;
	      case 2:
	        drawIdleTower(tower1, ctx, towerImg, 0, enemy1);
	        break;
	      default:
	
	    }
	
	    // if(counter > 120 && counter <= 600) {
	    //   status = 1;
	    // } else {
	    //   status = 0;
	    // }
	    //
	    // if (status > 0) {
	    //   drawSmoke(enemy1, tower1, factor, targetFactor);
	    //   if(targetFactor < 1) {
	    //     targetFactor += 1/60;
	    //   } else {
	    //     targetFactor = 1;
	    //   }
	    // } else if (status === 0 && targetFactor > 0) {
	    //   drawCircularSmoke(enemy1, ctx, factor);
	    //   // Smoke soll sich zum Turm hinbewegen
	    //   targetFactor -= 1 / 60;
	    // }
	    //
	    // if (status > 0 && targetFactor >= 1) {
	    //   drawSmoke(enemy2, enemy1, 1.5, enemyFactor);
	    //   if(enemyFactor < 1) {
	    //     enemyFactor += 1/60;
	    //   } else {
	    //     enemyFactor = 1;
	    //   }
	    // }
	
	    // drawTower(tower1, ctx, towerImg, status, enemy1);
	
	    enemy1.x += 1;
	    enemy2.x += 1;
	    enemy1.y -= 0;
	    counter += 1;
	  }
	
	  function calcStartingPoint(target, tower) {
	    var eX = target.x;
	    var eY = target.y;
	    var rE = target.radius;
	    var tX = tower.x;
	    var tY = tower.y;
	
	    var deltaY = -(eX - tX);
	    var deltaX = eY - tY;
	    var factor = rE / Math.sqrt(Math.pow(deltaX, 2) + Math.pow(deltaY, 2));
	    var startX = eX + deltaX * factor;
	    var startY = eY + deltaY * factor;
	    return { startX: startX, startY: startY };
	  }
	
	  function calcStartingAngle(target, tower, startX) {
	    var eX = target.x;
	    var rE = target.radius;
	    var tX = tower.x;
	    // let {startX} = start;
	
	    var angle = undefined;
	    if (eX <= tX) {
	      angle = Math.PI - Math.acos((eX - startX) / rE);
	    } else {
	      angle = Math.PI + Math.acos((eX - startX) / rE);
	    }
	    return angle;
	  }
	
	  function calcSmokeTarget(enemy, tower, factor, targetFactor) {
	    var eX = enemy.x;
	    var eY = enemy.y;
	    var eR = enemy.radius;
	    var tX = tower.x;
	    var tY = tower.y;
	
	    var x = tX + targetFactor * (eX - tX);
	    var y = tY + targetFactor * (eY - tY);
	    var radius = eR * factor * targetFactor;
	    return { x: x, y: y, radius: radius };
	  }
	
	  function drawEnemy(enemy, ctx) {
	    ctx.beginPath();
	    ctx.arc(enemy.x, enemy.y, enemy.radius, 0, 2 * Math.PI);
	    ctx.fillStyle = "red";
	    ctx.fill();
	    ctx.closePath();
	  }
	
	  function drawIdleTower(tower, ctx, img, status) {
	    ctx.drawImage(img, 0, status * 70, 60, 60, tower.x - tower.radius, tower.y - tower.radius, 2 * tower.radius, 2 * tower.radius);
	  }
	
	  function drawRotatingTower(tower, ctx, img, status, startingAngle) {
	    ctx.save();
	    ctx.translate(tower.x, tower.y);
	    ctx.rotate(startingAngle - Math.PI);
	    ctx.drawImage(img, 0, status * 70, 60, 60, -tower.radius, -tower.radius, 2 * tower.radius, 2 * tower.radius);
	    ctx.restore();
	  }
	
	  function drawSmoke(enemy, tower, factor, targetFactor, smoke, startX, startY, startingAngle, ctx) {
	    var endAngle = startingAngle + Math.PI;
	
	    ctx.save();
	    ctx.beginPath();
	    ctx.moveTo(tower.x, tower.y);
	    ctx.lineTo(startX, startY);
	    ctx.arc(smoke.x, smoke.y, smoke.radius, startingAngle, endAngle, false);
	    ctx.lineTo(tower.x, tower.y);
	    ctx.closePath();
	    ctx.clip();
	    ctx.drawImage(qualm, 0, 0, 800, 600);
	    ctx.restore();
	  }
	
	  function drawCircularSmoke(enemy, ctx, factor) {
	    var x = enemy.x;
	    var y = enemy.y;
	    var radius = enemy.radius;
	
	    ctx.beginPath();
	    ctx.fillStyle = "rgba(155, 155, 155, 0.5)";
	    ctx.arc(x, y, radius * factor, 0, 2 * Math.PI);
	    ctx.fill();
	    ctx.closePath();
	  }
	
	  function drawChainSmoke(enemy, target, ctx, factor, img) {
	    var x = target.x;
	    var y = target.y;
	    var r = target.radius;
	
	    var _calcRectPoints = calcRectPoints(enemy, target);
	
	    var px1 = _calcRectPoints.px1;
	    var px2 = _calcRectPoints.px2;
	    var px3 = _calcRectPoints.px3;
	    var px4 = _calcRectPoints.px4;
	    var py1 = _calcRectPoints.py1;
	    var py2 = _calcRectPoints.py2;
	    var py3 = _calcRectPoints.py3;
	    var py4 = _calcRectPoints.py4;
	
	    console.log(px1, px2, px3, px4, py1, py2, py3, py4);
	    ctx.save();
	    ctx.beginPath();
	    ctx.moveTo(px1, py1);
	    ctx.lineTo(px2, py2);
	    ctx.lineTo(px4, py4);
	    ctx.lineTo(px3, py3);
	    ctx.lineTo(px1, py1);
	    ctx.closePath();
	    ctx.clip();
	    ctx.drawImage(img, 0, 0, 800, 600);
	    ctx.restore();
	    ctx.save();
	    ctx.beginPath();
	    ctx.arc(x, y, r * factor, 0, 2 * Math.PI);
	    ctx.closePath();
	    ctx.clip();
	    ctx.drawImage(img, 0, 0, 800, 600);
	    ctx.restore();
	  }
	
	  function calcRectPoints(enemy, target) {
	    var x1 = enemy.x;
	    var y1 = enemy.y;
	    var r1 = enemy.radius;
	    var x2 = target.x;
	    var y2 = target.y;
	    var r2 = target.radius;
	
	    var deltaX = -(y1 - y2);
	    var deltaY = -(x1 - x2);
	    var width = r2 / Math.sqrt(Math.pow(deltaX, 2) + Math.pow(deltaY, 2));
	    var px1 = x1 - 0.5 * width * deltaX;
	    var px2 = x1 + 0.5 * width * deltaX;
	    var px3 = x2 - 0.5 * width * deltaX;
	    var px4 = x2 + 0.5 * width * deltaX;
	    var py1 = y1 - 0.5 * width * deltaY;
	    var py2 = y1 + 0.5 * width * deltaY;
	    var py3 = y2 - 0.5 * width * deltaY;
	    var py4 = y2 + 0.5 * width * deltaY;
	    return { px1: px1, px2: px2, px3: px3, px4: px4, py1: py1, py2: py2, py3: py3, py4: py4 };
	  }
	
	  // function calcDistance(enemy, tower) {
	  //   let {x: eX, y: eY} = enemy;
	  //   let {x: tX, y: tY} = tower;
	  //   return Math.sqrt(Math.pow((eX - tX), 2) + Math.pow((eY - tY), 2));
	  //
	  // }
	  function start() {
	    animationLoop();
	  }
	};

/***/ }
/******/ ]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgMmUzODI1ZjI3ODhiMGQ1MWU0MjUiLCJ3ZWJwYWNrOi8vLy4vaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHVCQUFlO0FBQ2Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7Ozs7Ozs7OztBQ3RDQSxPQUFNLENBQUMsTUFBTSxHQUFHLFlBQVk7O0FBRTFCLE9BQUksTUFBTSxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDL0MsT0FBSSxHQUFHLEdBQUcsTUFBTSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNsQyxPQUFJLFdBQVcsR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0FBQzFELE9BQUksSUFBSSxHQUFHLFdBQVcsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDeEMsT0FBSSxRQUFRLEdBQUcsSUFBSSxLQUFLLEVBQUUsQ0FBQztBQUMzQixPQUFJLEtBQUssR0FBRyxJQUFJLEtBQUssRUFBRSxDQUFDO0FBQ3hCLFdBQVEsQ0FBQyxNQUFNLEdBQUcsWUFBTTtBQUN0QixVQUFLLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQztBQUNyQixVQUFLLENBQUMsR0FBRyxHQUFHLFdBQVcsQ0FBQztJQUN6QixDQUFDO0FBQ0YsV0FBUSxDQUFDLEdBQUcsR0FBRyxXQUFXLENBQUM7QUFDM0IsT0FBSSxNQUFNLEdBQUcsRUFBQyxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBQyxDQUFDO0FBQzFDLE9BQUksTUFBTSxHQUFHLEVBQUMsQ0FBQyxF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QUN6QixTQUFJLE1BQU0sR0FBRyxFQUFHLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztBQUN6QixTQUFJLEtBQUssR0FBRyxFQUFFLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3RFLFNBQUksR0FBRyxHQUFHLEVBQUUsR0FBRyxHQUFHLEdBQUcsS0FBSyxHQUFHLE1BQU0sQ0FBQztBQUNwQyxTQUFJLEdBQUcsR0FBRyxFQUFFLEdBQUcsR0FBRyxHQUFHLEtBQUssR0FBRyxNQUFNLENBQUM7QUFDcEMsU0FBSSxHQUFHLEdBQUcsRUFBRSxHQUFHLEdBQUcsR0FBRyxLQUFLLEdBQUcsTUFBTSxDQUFDO0FBQ3BDLFNBQUksR0FBRyxHQUFHLEVBQUUsR0FBRyxHQUFHLEdBQUcsS0FBSyxHQUFHLE1BQU0sQ0FBQztBQUNwQyxTQUFJLEdBQUcsR0FBRyxFQUFFLEdBQUcsR0FBRyxHQUFHLEtBQUssR0FBRyxNQUFNLENBQUM7QUFDcEMsU0FBSSxHQUFHLEdBQUcsRUFBRSxHQUFHLEdBQUcsR0FBRyxLQUFLLEdBQUcsTUFBTSxDQUFDO0FBQ3BDLFNBQUksR0FBRyxHQUFHLEVBQUUsR0FBRyxHQUFHLEdBQUcsS0FBSyxHQUFHLE1BQU0sQ0FBQztBQUNwQyxTQUFJLEdBQUcsR0FBRyxFQUFFLEdBQUcsR0FBRyxHQUFHLEtBQUssR0FBRyxNQUFNLENBQUM7QUFDcEMsWUFBTyxFQUFDLEdBQUcsRUFBSCxHQUFHLEVBQUUsR0FBRyxFQUFILEdBQUcsRUFBRSxHQUFHLEVBQUgsR0FBRyxFQUFFLEdBQUcsRUFBSCxHQUFHLEVBQUUsR0FBRyxFQUFILEdBQUcsRUFBRSxHQUFHLEVBQUgsR0FBRyxFQUFFLEdBQUcsRUFBSCxHQUFHLEVBQUUsR0FBRyxFQUFILEdBQUcsRUFBQyxDQUFDO0lBQ2pEOzs7Ozs7OztBQVFELFlBQVMsS0FBSyxHQUFHO0FBQ2Ysa0JBQWEsRUFBRSxDQUFDO0lBQ2pCO0VBRUYsQyIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHdlYnBhY2svYm9vdHN0cmFwIDJlMzgyNWYyNzg4YjBkNTFlNDI1XG4gKiovIiwid2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcblxuICBsZXQgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW52YXNcIik7XG4gIGxldCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xuICBsZXQgY2FudmFzU21va2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNhbnZhcy1zbW9rZVwiKTtcbiAgbGV0IGN0eHMgPSBjYW52YXNTbW9rZS5nZXRDb250ZXh0KFwiMmRcIik7XG4gIGxldCB0b3dlckltZyA9IG5ldyBJbWFnZSgpO1xuICBsZXQgcXVhbG0gPSBuZXcgSW1hZ2UoKTtcbiAgdG93ZXJJbWcub25sb2FkID0gKCkgPT4ge1xuICAgIHF1YWxtLm9ubG9hZCA9IHN0YXJ0O1xuICAgIHF1YWxtLnNyYyA9IFwicXVhbG0ucG5nXCI7XG4gIH07XG4gIHRvd2VySW1nLnNyYyA9IFwidG93ZXIucG5nXCI7XG4gIGxldCBlbmVteTEgPSB7eDogMTAwLCB5OiA1MDAsIHJhZGl1czogMTV9O1xuICBsZXQgZW5lbXkyID0ge3g6IC0xMDAsIHk6IDUwMCwgcmFkaXVzOiAxNX07XG4gIGxldCB0b3dlcjEgPSB7eDogNTAwLCB5OiAyMDAsIHJhZGl1czogMjV9O1xuICBsZXQgZmFjdG9yID0gMjtcbiAgbGV0IHRhcmdldEZhY3RvciA9IDA7XG4gIGxldCBjb3VudGVyID0gMDtcbiAgbGV0IHN0YXR1cyA9IDA7IC8vaWRsZSwgMTogc2hvb3RpbmcsIDI6IHJlbG9hZGluZ1xuICBsZXQgZW5lbXlGYWN0b3IgPSAwO1xuXG5cblxuICBmdW5jdGlvbiBhbmltYXRpb25Mb29wKCkge1xuXG4gICAgICBpZihjb3VudGVyIDw9IDgwMCkge1xuICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGlvbkxvb3ApO1xuICAgICAgfVxuICAgICAgY3R4cy5nbG9iYWxBbHBoYSA9IDAuNTtcbiAgICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgODAwLCA2MDApO1xuICAgICAgY3R4cy5jbGVhclJlY3QoMCwgMCwgODAwLCA2MDApO1xuICAgICAgZHJhd0VuZW15KGVuZW15MSwgY3R4KTtcbiAgICAgIGRyYXdFbmVteShlbmVteTIsIGN0eCk7XG5cbiAgICAgIGlmIChjb3VudGVyID4gMTIwICYmIGNvdW50ZXIgPD0gNDAwKSB7XG4gICAgICAgIHN0YXR1cyA9IDE7XG4gICAgICB9IGVsc2UgaWYgKGNvdW50ZXIgPiAzMDAgJiYgY291bnRlciA8PSA1NTApIHtcbiAgICAgICAgc3RhdHVzID0gMjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN0YXR1cyA9IDA7XG4gICAgICB9XG5cbiAgICAgIHN3aXRjaCAoc3RhdHVzKSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIGRyYXdJZGxlVG93ZXIodG93ZXIxLCBjdHgsIHRvd2VySW1nLCAwLCBlbmVteTEpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgbGV0IHNtb2tlID0gY2FsY1Ntb2tlVGFyZ2V0KGVuZW15MSwgdG93ZXIxLCBmYWN0b3IsIHRhcmdldEZhY3Rvcik7XG4gICAgICAgICAgbGV0IHtzdGFydFgsIHN0YXJ0WX0gPSBjYWxjU3RhcnRpbmdQb2ludChzbW9rZSwgdG93ZXIxKTtcbiAgICAgICAgICBsZXQgc3RhcnRpbmdBbmdsZSA9IGNhbGNTdGFydGluZ0FuZ2xlKHNtb2tlLCB0b3dlcjEsIHN0YXJ0WCk7XG4gICAgICAgICAgaWYodGFyZ2V0RmFjdG9yIDwgMSkge1xuICAgICAgICAgICAgdGFyZ2V0RmFjdG9yICs9IDEvNjA7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRhcmdldEZhY3RvciA9IDE7XG4gICAgICAgICAgfVxuICAgICAgICAgICAgZHJhd1JvdGF0aW5nVG93ZXIodG93ZXIxLCBjdHgsIHRvd2VySW1nLCBzdGF0dXMsIHN0YXJ0aW5nQW5nbGUpO1xuICAgICAgICAgICAgZHJhd1Ntb2tlKGVuZW15MSwgdG93ZXIxLCBmYWN0b3IsIHRhcmdldEZhY3Rvciwgc21va2UsIHN0YXJ0WCwgc3RhcnRZLCBzdGFydGluZ0FuZ2xlLCBjdHhzKTtcbiAgICAgICAgICAgIGRyYXdDaGFpblNtb2tlKGVuZW15MSwgZW5lbXkyLCBjdHhzLCAxLjUsIHF1YWxtKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgZHJhd0lkbGVUb3dlcih0b3dlcjEsIGN0eCwgdG93ZXJJbWcsIDAsIGVuZW15MSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcblxuICAgICAgfVxuXG4gICAgICAvLyBpZihjb3VudGVyID4gMTIwICYmIGNvdW50ZXIgPD0gNjAwKSB7XG4gICAgICAvLyAgIHN0YXR1cyA9IDE7XG4gICAgICAvLyB9IGVsc2Uge1xuICAgICAgLy8gICBzdGF0dXMgPSAwO1xuICAgICAgLy8gfVxuICAgICAgLy9cbiAgICAgIC8vIGlmIChzdGF0dXMgPiAwKSB7XG4gICAgICAvLyAgIGRyYXdTbW9rZShlbmVteTEsIHRvd2VyMSwgZmFjdG9yLCB0YXJnZXRGYWN0b3IpO1xuICAgICAgLy8gICBpZih0YXJnZXRGYWN0b3IgPCAxKSB7XG4gICAgICAvLyAgICAgdGFyZ2V0RmFjdG9yICs9IDEvNjA7XG4gICAgICAvLyAgIH0gZWxzZSB7XG4gICAgICAvLyAgICAgdGFyZ2V0RmFjdG9yID0gMTtcbiAgICAgIC8vICAgfVxuICAgICAgLy8gfSBlbHNlIGlmIChzdGF0dXMgPT09IDAgJiYgdGFyZ2V0RmFjdG9yID4gMCkge1xuICAgICAgLy8gICBkcmF3Q2lyY3VsYXJTbW9rZShlbmVteTEsIGN0eCwgZmFjdG9yKTtcbiAgICAgIC8vICAgLy8gU21va2Ugc29sbCBzaWNoIHp1bSBUdXJtIGhpbmJld2VnZW5cbiAgICAgIC8vICAgdGFyZ2V0RmFjdG9yIC09IDEgLyA2MDtcbiAgICAgIC8vIH1cbiAgICAgIC8vXG4gICAgICAvLyBpZiAoc3RhdHVzID4gMCAmJiB0YXJnZXRGYWN0b3IgPj0gMSkge1xuICAgICAgLy8gICBkcmF3U21va2UoZW5lbXkyLCBlbmVteTEsIDEuNSwgZW5lbXlGYWN0b3IpO1xuICAgICAgLy8gICBpZihlbmVteUZhY3RvciA8IDEpIHtcbiAgICAgIC8vICAgICBlbmVteUZhY3RvciArPSAxLzYwO1xuICAgICAgLy8gICB9IGVsc2Uge1xuICAgICAgLy8gICAgIGVuZW15RmFjdG9yID0gMTtcbiAgICAgIC8vICAgfVxuICAgICAgLy8gfVxuXG5cbiAgICAgIC8vIGRyYXdUb3dlcih0b3dlcjEsIGN0eCwgdG93ZXJJbWcsIHN0YXR1cywgZW5lbXkxKTtcblxuICAgICAgZW5lbXkxLnggKz0gMTtcbiAgICAgIGVuZW15Mi54ICs9IDE7XG4gICAgICBlbmVteTEueSAtPSAwO1xuICAgICAgY291bnRlciArPSAxO1xuICB9XG5cbiAgZnVuY3Rpb24gY2FsY1N0YXJ0aW5nUG9pbnQodGFyZ2V0LCB0b3dlcikge1xuICAgIGxldCB7eDogZVgsIHk6IGVZLCByYWRpdXM6IHJFfSA9IHRhcmdldDtcbiAgICBsZXQge3g6IHRYLCB5OiB0WX0gPSB0b3dlcjtcbiAgICBsZXQgZGVsdGFZID0gLShlWCAtIHRYKTtcbiAgICBsZXQgZGVsdGFYID0gZVkgLSB0WTtcbiAgICBsZXQgZmFjdG9yID0gckUgLyBNYXRoLnNxcnQoTWF0aC5wb3coZGVsdGFYLCAyKSArIE1hdGgucG93KGRlbHRhWSwgMikpO1xuICAgIGxldCBzdGFydFggPSBlWCArIGRlbHRhWCAqIGZhY3RvcjtcbiAgICBsZXQgc3RhcnRZID0gZVkgKyBkZWx0YVkgKiBmYWN0b3I7XG4gICAgcmV0dXJuIHtzdGFydFgsIHN0YXJ0WX07XG4gIH1cblxuICBmdW5jdGlvbiBjYWxjU3RhcnRpbmdBbmdsZSh0YXJnZXQsIHRvd2VyLCBzdGFydFgpIHtcbiAgICBsZXQge3g6IGVYLCByYWRpdXM6IHJFfSA9IHRhcmdldDtcbiAgICBsZXQge3g6IHRYfSA9IHRvd2VyO1xuICAgIC8vIGxldCB7c3RhcnRYfSA9IHN0YXJ0O1xuICAgIGxldCBhbmdsZTtcbiAgICBpZihlWCA8PSB0WCkge1xuICAgICAgYW5nbGUgPSBNYXRoLlBJIC0gTWF0aC5hY29zKChlWCAtIHN0YXJ0WCkgLyByRSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFuZ2xlID0gTWF0aC5QSSArIE1hdGguYWNvcygoZVgtc3RhcnRYKSAvIHJFKTtcbiAgICB9XG4gICAgcmV0dXJuIGFuZ2xlO1xuICB9XG5cbiAgZnVuY3Rpb24gY2FsY1Ntb2tlVGFyZ2V0KGVuZW15LCB0b3dlciwgZmFjdG9yLCB0YXJnZXRGYWN0b3IpIHtcbiAgICBsZXQge3g6IGVYLCB5OiBlWSwgcmFkaXVzOiBlUn0gPSBlbmVteTtcbiAgICBsZXQge3g6IHRYLCB5OiB0WX0gPSB0b3dlcjtcbiAgICBsZXQgeCA9IHRYICsgdGFyZ2V0RmFjdG9yICogKGVYIC0gdFgpO1xuICAgIGxldCB5ID0gdFkgKyB0YXJnZXRGYWN0b3IgKiAoZVkgLSB0WSk7XG4gICAgbGV0IHJhZGl1cyA9IGVSICogZmFjdG9yICogdGFyZ2V0RmFjdG9yO1xuICAgIHJldHVybiB7eCwgeSwgcmFkaXVzfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGRyYXdFbmVteShlbmVteSwgY3R4KSB7XG4gICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgIGN0eC5hcmMoZW5lbXkueCwgZW5lbXkueSwgZW5lbXkucmFkaXVzLCAwLCAyICogTWF0aC5QSSk7XG4gICAgY3R4LmZpbGxTdHlsZSA9IFwicmVkXCI7XG4gICAgY3R4LmZpbGwoKTtcbiAgICBjdHguY2xvc2VQYXRoKCk7XG4gIH1cblxuICBmdW5jdGlvbiBkcmF3SWRsZVRvd2VyKHRvd2VyLCBjdHgsIGltZywgc3RhdHVzKSB7XG4gICAgY3R4LmRyYXdJbWFnZShpbWcsIDAsIHN0YXR1cyAqIDcwLCA2MCwgNjAsIHRvd2VyLnggLSB0b3dlci5yYWRpdXMsIHRvd2VyLnkgLSB0b3dlci5yYWRpdXMsIDIgKiB0b3dlci5yYWRpdXMsIDIgKiB0b3dlci5yYWRpdXMpO1xuICB9XG5cbiAgZnVuY3Rpb24gZHJhd1JvdGF0aW5nVG93ZXIodG93ZXIsIGN0eCwgaW1nLCBzdGF0dXMsIHN0YXJ0aW5nQW5nbGUpIHtcbiAgICAgIGN0eC5zYXZlKCk7XG4gICAgICBjdHgudHJhbnNsYXRlKHRvd2VyLngsIHRvd2VyLnkpO1xuICAgICAgY3R4LnJvdGF0ZShzdGFydGluZ0FuZ2xlIC0gTWF0aC5QSSk7XG4gICAgICBjdHguZHJhd0ltYWdlKGltZywgMCwgc3RhdHVzICogNzAsIDYwLCA2MCwgLXRvd2VyLnJhZGl1cyAsIC10b3dlci5yYWRpdXMsIDIgKiB0b3dlci5yYWRpdXMsIDIgKiB0b3dlci5yYWRpdXMpO1xuICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGRyYXdTbW9rZShlbmVteSwgdG93ZXIsIGZhY3RvciwgdGFyZ2V0RmFjdG9yLCBzbW9rZSwgc3RhcnRYLCBzdGFydFksIHN0YXJ0aW5nQW5nbGUsIGN0eCkge1xuICAgIGxldCBlbmRBbmdsZSA9IHN0YXJ0aW5nQW5nbGUgKyBNYXRoLlBJO1xuXG4gICAgY3R4LnNhdmUoKTtcbiAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgY3R4Lm1vdmVUbyh0b3dlci54LCB0b3dlci55KTtcbiAgICBjdHgubGluZVRvKHN0YXJ0WCwgc3RhcnRZKTtcbiAgICBjdHguYXJjKHNtb2tlLngsIHNtb2tlLnksIHNtb2tlLnJhZGl1cywgc3RhcnRpbmdBbmdsZSwgZW5kQW5nbGUsIGZhbHNlKTtcbiAgICBjdHgubGluZVRvKHRvd2VyLngsIHRvd2VyLnkpO1xuICAgIGN0eC5jbG9zZVBhdGgoKTtcbiAgICBjdHguY2xpcCgpO1xuICAgIGN0eC5kcmF3SW1hZ2UocXVhbG0sIDAsIDAsIDgwMCwgNjAwKTtcbiAgICBjdHgucmVzdG9yZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gZHJhd0NpcmN1bGFyU21va2UoZW5lbXksIGN0eCwgZmFjdG9yKSB7XG4gICAgbGV0IHt4LCB5LCByYWRpdXN9ID0gZW5lbXk7XG4gICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgIGN0eC5maWxsU3R5bGUgPSBcInJnYmEoMTU1LCAxNTUsIDE1NSwgMC41KVwiO1xuICAgIGN0eC5hcmMoeCwgeSwgcmFkaXVzICogZmFjdG9yLCAwLCAyICogTWF0aC5QSSk7XG4gICAgY3R4LmZpbGwoKTtcbiAgICBjdHguY2xvc2VQYXRoKCk7XG4gIH1cblxuICBmdW5jdGlvbiBkcmF3Q2hhaW5TbW9rZShlbmVteSwgdGFyZ2V0LCBjdHgsIGZhY3RvciwgaW1nKSB7XG4gICAgbGV0IHt4OiB4LCB5OiB5LCByYWRpdXM6IHJ9ID0gdGFyZ2V0O1xuICAgIGxldCB7cHgxLCBweDIsIHB4MywgcHg0LCBweTEsIHB5MiwgcHkzLCBweTR9ID0gY2FsY1JlY3RQb2ludHMoZW5lbXksIHRhcmdldCk7XG4gICAgY29uc29sZS5sb2cocHgxLCBweDIsIHB4MywgcHg0LCBweTEsIHB5MiwgcHkzLCBweTQpO1xuICAgIGN0eC5zYXZlKCk7XG4gICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgIGN0eC5tb3ZlVG8ocHgxLCBweTEpO1xuICAgIGN0eC5saW5lVG8ocHgyLCBweTIpO1xuICAgIGN0eC5saW5lVG8ocHg0LCBweTQpO1xuICAgIGN0eC5saW5lVG8ocHgzLCBweTMpO1xuICAgIGN0eC5saW5lVG8ocHgxLCBweTEpO1xuICAgIGN0eC5jbG9zZVBhdGgoKTtcbiAgICBjdHguY2xpcCgpO1xuICAgIGN0eC5kcmF3SW1hZ2UoaW1nLCAwLCAwLCA4MDAsIDYwMCk7XG4gICAgY3R4LnJlc3RvcmUoKTtcbiAgICBjdHguc2F2ZSgpO1xuICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICBjdHguYXJjKHgsIHksIHIgKiBmYWN0b3IsIDAsIDIgKiBNYXRoLlBJKTtcbiAgICBjdHguY2xvc2VQYXRoKCk7XG4gICAgY3R4LmNsaXAoKTtcbiAgICBjdHguZHJhd0ltYWdlKGltZywgMCwgMCwgODAwLCA2MDApO1xuICAgIGN0eC5yZXN0b3JlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBjYWxjUmVjdFBvaW50cyhlbmVteSwgdGFyZ2V0KSB7XG4gICAgbGV0IHt4OiB4MSwgeTogeTEsIHJhZGl1czogcjF9ID0gZW5lbXk7XG4gICAgbGV0IHt4OiB4MiwgeTogeTIsIHJhZGl1czogcjJ9ID0gdGFyZ2V0O1xuXG4gICAgbGV0IGRlbHRhWCA9IC0gKHkxIC0geTIpO1xuICAgIGxldCBkZWx0YVkgPSAtICh4MSAtIHgyKTtcbiAgICBsZXQgd2lkdGggPSByMiAvIE1hdGguc3FydChNYXRoLnBvdyhkZWx0YVgsIDIpICsgTWF0aC5wb3coZGVsdGFZLCAyKSk7XG4gICAgbGV0IHB4MSA9IHgxIC0gMC41ICogd2lkdGggKiBkZWx0YVg7XG4gICAgbGV0IHB4MiA9IHgxICsgMC41ICogd2lkdGggKiBkZWx0YVg7XG4gICAgbGV0IHB4MyA9IHgyIC0gMC41ICogd2lkdGggKiBkZWx0YVg7XG4gICAgbGV0IHB4NCA9IHgyICsgMC41ICogd2lkdGggKiBkZWx0YVg7XG4gICAgbGV0IHB5MSA9IHkxIC0gMC41ICogd2lkdGggKiBkZWx0YVk7XG4gICAgbGV0IHB5MiA9IHkxICsgMC41ICogd2lkdGggKiBkZWx0YVk7XG4gICAgbGV0IHB5MyA9IHkyIC0gMC41ICogd2lkdGggKiBkZWx0YVk7XG4gICAgbGV0IHB5NCA9IHkyICsgMC41ICogd2lkdGggKiBkZWx0YVk7XG4gICAgcmV0dXJuIHtweDEsIHB4MiwgcHgzLCBweDQsIHB5MSwgcHkyLCBweTMsIHB5NH07XG4gIH1cblxuICAvLyBmdW5jdGlvbiBjYWxjRGlzdGFuY2UoZW5lbXksIHRvd2VyKSB7XG4gIC8vICAgbGV0IHt4OiBlWCwgeTogZVl9ID0gZW5lbXk7XG4gIC8vICAgbGV0IHt4OiB0WCwgeTogdFl9ID0gdG93ZXI7XG4gIC8vICAgcmV0dXJuIE1hdGguc3FydChNYXRoLnBvdygoZVggLSB0WCksIDIpICsgTWF0aC5wb3coKGVZIC0gdFkpLCAyKSk7XG4gIC8vXG4gIC8vIH1cbiAgZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgYW5pbWF0aW9uTG9vcCgpO1xuICB9XG5cbn07XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL2luZGV4LmpzXG4gKiovIl0sInNvdXJjZVJvb3QiOiIifQ==